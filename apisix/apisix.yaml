routes:
  # User Service Routes
  - id: 1
    uri: /api/v1/users/*
    name: "user-service-route"
    methods:
      - GET
      - POST
      - PUT
      - DELETE
    upstream:
      type: roundrobin
      nodes:
        "user-service:8081": 1
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
        allow_headers: "*"
        expose_headers: "*"
        max_age: 3600
      rate-limit:
        count: 100
        time_window: 60
        rejected_code: 429
        rejected_msg: "Rate limit exceeded"

  # Merchant Service Routes
  - id: 2
    uri: /api/v1/merchants/*
    name: "merchant-service-route"
    methods:
      - GET
      - POST
      - PUT
      - DELETE
    upstream:
      type: roundrobin
      nodes:
        "merchant-service:8082": 1
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
        allow_headers: "*"
        expose_headers: "*"
        max_age: 3600
      rate-limit:
        count: 100
        time_window: 60
        rejected_code: 429
        rejected_msg: "Rate limit exceeded"

  # Voucher Service Routes
  - id: 3
    uri: /api/v1/vouchers/*
    name: "voucher-service-route"
    methods:
      - GET
      - POST
      - PUT
      - DELETE
    upstream:
      type: roundrobin
      nodes:
        "voucher-service:8083": 1
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
        allow_headers: "*"
        expose_headers: "*"
        max_age: 3600
      rate-limit:
        count: 100
        time_window: 60
        rejected_code: 429
        rejected_msg: "Rate limit exceeded"

  # Transaction Service Routes
  - id: 4
    uri: /api/v1/transactions/*
    name: "transaction-service-route"
    methods:
      - GET
      - POST
      - PUT
      - DELETE
    upstream:
      type: roundrobin
      nodes:
        "transaction-service:8084": 1
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
        allow_headers: "*"
        expose_headers: "*"
        max_age: 3600
      rate-limit:
        count: 100
        time_window: 60
        rejected_code: 429
        rejected_msg: "Rate limit exceeded"

  # Payment Service Routes
  - id: 5
    uri: /api/v1/payments/*
    name: "payment-service-route"
    methods:
      - GET
      - POST
      - PUT
      - DELETE
    upstream:
      type: roundrobin
      nodes:
        "payment-service:8085": 1
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
        allow_headers: "*"
        expose_headers: "*"
        max_age: 3600
      rate-limit:
        count: 100
        time_window: 60
        rejected_code: 429
        rejected_msg: "Rate limit exceeded"

  # Corporate Service Routes
  - id: 6
    uri: /api/v1/corporate/*
    name: "corporate-service-route"
    methods:
      - GET
      - POST
      - PUT
      - DELETE
    upstream:
      type: roundrobin
      nodes:
        "corporate-service:8086": 1
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
        allow_headers: "*"
        expose_headers: "*"
        max_age: 3600
      rate-limit:
        count: 100
        time_window: 60
        rejected_code: 429
        rejected_msg: "Rate limit exceeded"

  # Health Check Route
  - id: 7
    uri: /health
    name: "health-check-route"
    methods:
      - GET
    upstream:
      type: roundrobin
      nodes:
        "test-service:8080": 1
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "GET"
        allow_headers: "*"
        expose_headers: "*"
        max_age: 3600

# Global Plugins
plugins:
  - name: "cors"
    config:
      allow_origins: "*"
      allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
      allow_headers: "*"
      expose_headers: "*"
      max_age: 3600
  - name: "rate-limit"
    config:
      count: 1000
      time_window: 60
      rejected_code: 429
      rejected_msg: "Global rate limit exceeded"
